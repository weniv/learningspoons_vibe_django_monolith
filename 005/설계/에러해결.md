# Django 블로그 에러 해결 가이드

## 1번 에러: 로그아웃이 안되는 문제

### 문제 상황
로그아웃 링크를 클릭해도 로그아웃이 되지 않는 문제

### 원인 분석
Django 3.0 이후부터 `LogoutView`는 보안상의 이유로 **GET 요청을 허용하지 않고 POST 요청만 허용**합니다.
현재 네비게이션 바에서 `<a>` 태그로 로그아웃 링크를 클릭하면 GET 요청이 발생하므로 로그아웃이 작동하지 않습니다.

### 해결 방법 (3가지 중 선택)

---

#### 방법 1: POST 폼으로 로그아웃 처리 (권장)
보안상 가장 권장되는 방법입니다.

**템플릿 수정**
```html
<!-- main/templates/main/base.html 수정 -->
<!-- 기존 코드 -->
<a href="{% url 'accounts:logout' %}">로그아웃</a>

<!-- 수정 후 코드 -->
<form method="post" action="{% url 'accounts:logout' %}" style="display: inline;">
    {% csrf_token %}
    <button type="submit" style="background: none; border: none; color: white; cursor: pointer; padding: 0.5rem 1rem;">
        로그아웃
    </button>
</form>
```

**CSS 추가 (버튼을 링크처럼 보이게)**
```html
<!-- base.html의 <style> 태그 안에 추가 -->
<style>
    /* 기존 스타일... */

    /* 로그아웃 버튼 스타일 */
    .logout-button {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        padding: 0.5rem 1rem;
        font-size: 1rem;
        font-family: inherit;
        transition: background-color 0.3s;
        border-radius: 4px;
    }
    .logout-button:hover {
        background-color: #34495e;
    }
</style>
```

**업데이트된 네비게이션 코드**
```html
<div class="nav-right">
    {% if user.is_authenticated %}
        <a href="{% url 'main:post_create' %}">글쓰기</a>
        <span style="color: white; padding: 0.5rem 1rem;">{{ user.username }}님</span>
        <form method="post" action="{% url 'accounts:logout' %}" style="display: inline; margin: 0;">
            {% csrf_token %}
            <button type="submit" class="logout-button">로그아웃</button>
        </form>
    {% else %}
        <a href="{% url 'accounts:login' %}">로그인</a>
        <a href="{% url 'accounts:signup' %}">회원가입</a>
    {% endif %}
</div>
```

---

#### 방법 2: 커스텀 로그아웃 뷰 만들기
GET 요청도 처리할 수 있는 커스텀 뷰를 만듭니다.

**accounts/views.py 수정**
```python
# 기존 LogoutView 클래스를 삭제하고 아래 코드로 교체

from django.contrib.auth import logout
from django.shortcuts import redirect
from django.views import View

class LogoutView(View):
    """GET 요청도 처리 가능한 커스텀 로그아웃 뷰"""

    def get(self, request):
        logout(request)
        return redirect('main:home')

    def post(self, request):
        logout(request)
        return redirect('main:home')
```

---

#### 방법 3: Django 내장 LogoutView에 GET 허용 설정
Django 내장 LogoutView의 `http_method_names`를 수정합니다.

**accounts/views.py 수정**
```python
# 기존 LogoutView 클래스를 아래 코드로 교체

class LogoutView(DjangoLogoutView):
    next_page = "main:home"
    http_method_names = ["get", "post", "options"]  # GET 요청 허용
```

**주의**: 이 방법은 CSRF 보호가 약해지므로 개발 환경에서만 사용하고, 프로덕션에서는 방법 1을 사용하세요.

---

### 권장 사항
**방법 1 (POST 폼 사용)** 을 권장합니다. 이유는 다음과 같습니다:
- CSRF 공격 방지
- Django의 보안 정책 준수
- 표준 웹 보안 관행 따름

---

### 테스트 방법
1. 서버 재시작 (필요시)
   ```bash
   python manage.py runserver
   ```

2. 로그인 후 로그아웃 버튼 클릭

3. 홈 페이지로 리다이렉트되고 네비게이션 바에 "로그인", "회원가입" 링크가 표시되는지 확인

---

### 추가 정보: 왜 POST 요청을 사용해야 하나?
- **CSRF(Cross-Site Request Forgery) 공격 방지**: GET 요청은 URL만으로 실행되므로 악의적인 웹사이트에서 이미지 태그 등을 통해 사용자 모르게 로그아웃을 시킬 수 있습니다.
- **상태 변경 작업**: 로그아웃은 서버의 상태를 변경하는 작업이므로 RESTful 원칙에 따라 POST 요청을 사용해야 합니다.

---

## 향후 에러는 이 파일에 순차적으로 추가됩니다.
